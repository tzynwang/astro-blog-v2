<!DOCTYPE html>
<html lang="en" class="astro-D4ZPMAD2">
  <head>
    <!-- Global Metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="sitemap" href="/sitemap-index.xml">
    <meta name="generator" content="Astro v2.10.12">

    <!-- Primary Meta Tags -->
    <title>ã€Œä½¿ç”¨passportè™•ç†FBã€Googleç¬¬ä¸‰æ–¹ç™»å…¥ã€ç›¸é—œç­†è¨˜</title>
    <meta name="title" content="ã€Œä½¿ç”¨passportè™•ç†FBã€Googleç¬¬ä¸‰æ–¹ç™»å…¥ã€ç›¸é—œç­†è¨˜">
    <meta name="description" content="">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tzynwang.github.io/post/2021/express-passport-facebook-google-line/">
    <meta property="og:title" content="ã€Œä½¿ç”¨passportè™•ç†FBã€Googleç¬¬ä¸‰æ–¹ç™»å…¥ã€ç›¸é—œç­†è¨˜">
    <meta property="og:description" content="">
    <meta property="og:image" content="https://tzynwang.github.io/alexander-andrews-mEdKuPYJe1I.jpg">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://tzynwang.github.io/post/2021/express-passport-facebook-google-line/">
    <meta property="twitter:title" content="ã€Œä½¿ç”¨passportè™•ç†FBã€Googleç¬¬ä¸‰æ–¹ç™»å…¥ã€ç›¸é—œç­†è¨˜">
    <meta property="twitter:description" content="">
    <meta property="twitter:image" content="https://tzynwang.github.io/alexander-andrews-mEdKuPYJe1I.jpg">

    <!-- Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/_astro/index.5f60e57f.css" />
<link rel="stylesheet" href="/_astro/2-1-movie-list-i18n-note.5f900e92.css" /></head>
  <body class="astro-D4ZPMAD2">
    <section class="side-contnet astro-D4ZPMAD2">
      <h1 class="astro-D4ZPMAD2">æ™®é€šæ–‡çµ„ 2.0</h1>
      <nav class="astro-D4ZPMAD2">
        <a href="/" class="astro-D4ZPMAD2">é¦–é </a>
        <a href="/archive" class="astro-D4ZPMAD2">å…¨æ–‡ç« æ­¸æª”</a>
      </nav>
    </section>
    <section class="main-content astro-D4ZPMAD2">
      
  <div class="post-container astro-QTOKGA5Y">
    <h1 class="astro-QTOKGA5Y">ã€Œä½¿ç”¨passportè™•ç†FBã€Googleç¬¬ä¸‰æ–¹ç™»å…¥ã€ç›¸é—œç­†è¨˜</h1>
    <div class="info astro-QTOKGA5Y">
      <span class="astro-QTOKGA5Y">2021-06-30 12:59</span>
      <span class="astro-QTOKGA5Y"><span class="astro-2IYMVI75">
  Express
</span></span>
      <ul class="astro-QTOKGA5Y">
        <li class="toc-2 astro-QTOKGA5Y">
              <a href="#ç¸½çµ" class="astro-QTOKGA5Y">ç¸½çµ</a>
            </li><li class="toc-2 astro-QTOKGA5Y">
              <a href="#ç’°å¢ƒ" class="astro-QTOKGA5Y">ç’°å¢ƒ</a>
            </li><li class="toc-2 astro-QTOKGA5Y">
              <a href="#ç­†è¨˜" class="astro-QTOKGA5Y">ç­†è¨˜</a>
            </li><li class="toc-3 astro-QTOKGA5Y">
              <a href="#å°ˆæ¡ˆçµæ§‹" class="astro-QTOKGA5Y">å°ˆæ¡ˆçµæ§‹</a>
            </li><li class="toc-3 astro-QTOKGA5Y">
              <a href="#fb-æµç¨‹" class="astro-QTOKGA5Y">FB æµç¨‹</a>
            </li><li class="toc-3 astro-QTOKGA5Y">
              <a href="#google-æµç¨‹" class="astro-QTOKGA5Y">Google æµç¨‹</a>
            </li><li class="toc-3 astro-QTOKGA5Y">
              <a href="#line-æµç¨‹" class="astro-QTOKGA5Y">LINE æµç¨‹</a>
            </li><li class="toc-3 astro-QTOKGA5Y">
              <a href="#authjs-å…§å®¹" class="astro-QTOKGA5Y">auth.js å…§å®¹</a>
            </li><li class="toc-3 astro-QTOKGA5Y">
              <a href="#appjs-è¨­å®š" class="astro-QTOKGA5Y">app.js è¨­å®š</a>
            </li><li class="toc-2 astro-QTOKGA5Y">
              <a href="#é—œæ–¼-oauth-20" class="astro-QTOKGA5Y">é—œæ–¼ OAuth 2.0</a>
            </li><li class="toc-3 astro-QTOKGA5Y">
              <a href="#authentication" class="astro-QTOKGA5Y">Authentication</a>
            </li><li class="toc-3 astro-QTOKGA5Y">
              <a href="#authorization" class="astro-QTOKGA5Y">Authorization</a>
            </li><li class="toc-2 astro-QTOKGA5Y">
              <a href="#åƒè€ƒæ–‡ä»¶" class="astro-QTOKGA5Y">åƒè€ƒæ–‡ä»¶</a>
            </li>
      </ul>
    </div>
    <h2 id="ç¸½çµ">ç¸½çµ</h2>
<p>ä½¿ç”¨ npm package <code>passport-facebook</code>ã€<code>passport-google-oauth20</code>èˆ‡<code>passport-line</code>è®“ Todo List å°ˆæ¡ˆå¯ä»¥é€é FBã€Google æˆ– LINE å¸³è™Ÿé€²è¡Œç¬¬ä¸‰æ–¹ç™»å…¥</p>
<h2 id="ç’°å¢ƒ">ç’°å¢ƒ</h2>
<pre is:raw="" class="astro-code github-dark" style="background-color: #24292e; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #e1e4e8">passport: 0.4.1</span></span>
<span class="line"><span style="color: #e1e4e8">passport-facebook: 3.0.0</span></span>
<span class="line"><span style="color: #e1e4e8">passport-google-oauth20: 2.0.0</span></span>
<span class="line"><span style="color: #e1e4e8">passport-line: 0.0.4</span></span>
<span class="line"><span style="color: #e1e4e8">os: Windows_NT 10.0.18363 win32 x64</span></span></code></pre>
<h2 id="ç­†è¨˜">ç­†è¨˜</h2>
<h3 id="å°ˆæ¡ˆçµæ§‹">å°ˆæ¡ˆçµæ§‹</h3>
<p>åƒ…åˆ—å‡ºèˆ‡æœ¬æ¬¡å¯¦ä½œç›¸é—œçš„è³‡æ–™å¤¾èˆ‡æª”æ¡ˆï¼š</p>
<pre is:raw="" class="astro-code github-dark" style="background-color: #24292e; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #e1e4e8">config</span></span>
<span class="line"><span style="color: #e1e4e8">  passport_FB.js</span></span>
<span class="line"><span style="color: #e1e4e8">  passport_Google.js</span></span>
<span class="line"><span style="color: #e1e4e8">  passport_LINE.js</span></span>
<span class="line"><span style="color: #e1e4e8">models</span></span>
<span class="line"><span style="color: #e1e4e8">  user.js</span></span>
<span class="line"><span style="color: #e1e4e8">routes</span></span>
<span class="line"><span style="color: #e1e4e8">  modules</span></span>
<span class="line"><span style="color: #e1e4e8">    auth.js</span></span>
<span class="line"><span style="color: #e1e4e8">app.js</span></span></code></pre>
<h3 id="fb-æµç¨‹">FB æµç¨‹</h3>
<script src="https://gist.github.com/tzynwang/7b5d441f8127653fac09bbebd9a9ac0f.js"></script>
<p><img src="/2021/express-passport-facebook-google-line/fb_dashboard.jpg" alt="fb dashboard"></p>
<p>clientID èˆ‡ clientSecret éƒ½å¯åœ¨ FB é–‹ç™¼è€…å¾Œå°å–å¾—</p>
<h3 id="google-æµç¨‹">Google æµç¨‹</h3>
<script src="https://gist.github.com/tzynwang/26b84e1bfaccf5dc353ad01b0d2cfd65.js"></script>
<p>å¾Œå°æµç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>
<p>é€²å…¥ GCP å¾Œé¸æ“‡ APIs &#x26; Serviceï¼Œé¸æ“‡ Credentials ä¸¦å»ºç«‹æ–°çš„ Oath client ID</p>
<p><img src="/2021/express-passport-facebook-google-line/Google_step1.jpg" alt="Google step 1"></p>
</li>
<li>
<p>æ‡‰ç”¨ç¨‹å¼é¡å‹å› æ‡‰ç·´ç¿’å°ˆæ¡ˆé¸æ“‡ Web application</p>
<p><img src="/2021/express-passport-facebook-google-line/Google_step2.jpg" alt="Google step 2"></p>
</li>
<li>
<p>èˆ‡ FB è¼ƒç‚ºä¸åŒï¼ŒAuthorized redirect URIs ç‚ºå¿…å¡«ï¼Œç·´ç¿’æƒ…æ³ä¸‹ç›´æ¥å°å›<code>localhost:3000/&#x3C;auth/google/callback></code>å³å¯ï¼ˆå‰è¿°<code>&#x3C;></code>å…§å®¹èˆ‡ endpoint è¨­å®šä¸€è‡´ï¼‰</p>
<p><a href="/2021/express-passport-facebook-google-line/Google_step3.jpg">Google step 3</a></p>
</li>
</ol>
<h3 id="line-æµç¨‹">LINE æµç¨‹</h3>
<script src="https://gist.github.com/tzynwang/21340bfe58134bb6e1cb6a07e9def494.js"></script>
<p>å®˜æ–¹èªªæ˜æ–‡ä»¶ï¼š</p>
<ul>
<li><a href="https://developers.line.biz/en/docs/line-login/integrate-line-login/">Integrating LINE Login with your web app</a></li>
<li><a href="https://developers.line.biz/zh-hant/docs/line-login/integrate-line-login/">æ•´åˆ LINE Login èˆ‡ web app</a></li>
</ul>
<p>å®˜æ–¹ç”³è«‹å…¥å£ï¼š<a href="https://developers.line.biz/en/services/line-login/">LINE Developer: Products / LINE Login</a></p>
<p>å¾Œå°æµç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>
<p>èˆ‡ FB ä»¥åŠ Google è¼ƒä¸åŒï¼ŒLINE æ­é… passport è™•ç†ç¬¬ä¸‰æ–¹ç™»å…¥æœƒç”¨åˆ°çš„æ˜¯<strong>Channel</strong> ID èˆ‡<strong>Channel</strong> Secretï¼Œå…©ç­†è³‡æ–™å¯åœ¨ Basic Settings ä¸­è¤‡è£½</p>
<p><img src="/2021/express-passport-facebook-google-line/LINE_dashboard1.jpg" alt="LINE step 1">
<img src="/2021/express-passport-facebook-google-line/LINE_dashboard2.jpg" alt="LINE step 2"></p>
</li>
<li>
<p>åˆ‡æ›åˆ° LINE Login åˆ†é ï¼Œè¨­å®š Callback URL</p>
<p><img src="/2021/express-passport-facebook-google-line/LINE_dashboard3.jpg" alt="LINE step 3"></p>
</li>
<li>
<p>å…¶é¤˜æµç¨‹èˆ‡ FB ä»¥åŠ Google ç™»å…¥çš„å·®ç•°æ˜¯ï¼Œé€é LINE å‘ä½¿ç”¨è€…è¦æ±‚æˆæ¬Šæ™‚ï¼Œä¸éœ€è¦å¸¶å…¥<code>scope</code>è³‡æ–™ï¼ˆåƒè€ƒä»¥ä¸‹<code>auth.js</code>ç¬¬ 32 è¡Œï¼Œèˆ‡ FB ä»¥åŠ Google çš„å…§å®¹ä¸åŒï¼‰</p>
</li>
</ol>
<p>è£œå……ï¼š</p>
<ul>
<li>LINE Login<strong>ä¸æœƒ</strong>ä¸»å‹•æä¾›ä½¿ç”¨è€…çš„ Email è³‡è¨Šï¼Œè‹¥é ˆè«‹æ±‚ä½¿ç”¨è€…çš„ Emailï¼Œé–‹ç™¼è€…è¦è‡ªè¡Œç”³è«‹ Email address permission</li>
<li>åƒè€ƒï¼š<a href="https://developers.line.biz/en/docs/line-login/integrate-line-login/#applying-for-email-permission">Requesting permission to access the userâ€™s email address</a></li>
</ul>
<h3 id="authjs-å…§å®¹">auth.js å…§å®¹</h3>
<script src="https://gist.github.com/tzynwang/302a2a4b7098456bcd09f233093946a6.js"></script>
<h3 id="appjs-è¨­å®š">app.js è¨­å®š</h3>
<script src="https://gist.github.com/tzynwang/e9758c91408f8062498e2ef7f3ea6207.js"></script>
<p>è¨˜å¾—<code>require</code>åœ¨ config è³‡æ–™å¤¾ä¸­è¨­å®šå¥½çš„<code>passport_FB</code>èˆ‡<code>passport_Google</code>ä¸¦å‘¼å«ä¹‹å³å¯</p>
<h2 id="é—œæ–¼-oauth-20">é—œæ–¼ OAuth 2.0</h2>
<blockquote>
<p>OAuth allows you (the User) to grant access to your private resources on one site (which is called the Service Provider), to another site (called Consumer). While OpenID is all about using a single identity to sign into many sites, OAuth is about <strong>giving access to your stuff without sharing your identity at all</strong> (or its secret parts).</p>
</blockquote>
<p>Reference: <a href="https://hueniversedotcom.wordpress.com/2007/09/05/explaining-oauth/">Eran Hammer-Lahav: Explaining OAuth</a></p>
<h3 id="authentication">Authentication</h3>
<ul>
<li>Authentication is about <strong>proving you are the correct person</strong> because you know things.</li>
<li>Authentication means <strong>confirming your own identity</strong> (is the account and password correct?)</li>
<li>ï¼ˆé€éæä¾›æ­£ç¢ºçš„å¸³è™Ÿå¯†ç¢¼çµ„åˆï¼‰è­‰æ˜æˆ‘æ˜¯èª°</li>
</ul>
<h3 id="authorization">Authorization</h3>
<ul>
<li>Authorization is <strong>asking for permission</strong> to do stuff.</li>
<li>Authorization means <strong>granting access</strong> (is this user same as the one that just be authenticated?) to the system.</li>
<li><a href="https://oauth.net/2/">OAuth 2.0</a>: is the industry-standard protocol for <strong>authorization</strong>.</li>
<li>å…è¨±å“ªäº› APP ä¾†å­˜å–è³‡æ–™ï¼›ä»¥æœ¬æ¬¡ç·´ç¿’ä¾†èªªï¼Œå°±æ˜¯ã€Œæˆ‘åŒæ„æ­¤ Todo list å°ˆæ¡ˆå¯ä»¥å­˜å–æˆ‘åœ¨ FB æˆ–æ˜¯ Google å¸³è™Ÿä¸­çš„éƒ¨åˆ†è³‡æ–™ã€</li>
</ul>
<h2 id="åƒè€ƒæ–‡ä»¶">åƒè€ƒæ–‡ä»¶</h2>
<ul>
<li><a href="https://youtu.be/o9e3ex-axzA">YouTube: Express (NodeJS) - Google oAuth 2.0 (passportJS)</a></li>
<li>OAuth 2.0
<ul>
<li><a href="https://www.digitalocean.com/community/tutorials/an-introduction-to-oauth-2">DigitalOcean: An Introduction to OAuth 2</a></li>
<li><a href="https://www.varonis.com/blog/what-is-oauth/">What is OAuth? Definition and How it Works</a></li>
</ul>
</li>
</ul>
  </div>

      <footer class="astro-QLGQ3ONJ">Tzu Yin (Charlie) ğŸ¦Š Made in Taiwan</footer>
    </section>
  </body></html>